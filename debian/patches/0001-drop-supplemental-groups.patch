From: Chris Lamb <lamby@debian.org>
Date: Tue Oct 16 12:05:35 2012 +0100
Subject: 0001-drop-supplemental-groups

---
 gunicorn/util.py | 9 +++++++++
 1 file changed, 9 insertions(+)

--- a/gunicorn/util.py
+++ b/gunicorn/util.py
@@ -21,6 +21,7 @@ import inspect
 import errno
 import warnings
 import cgi
+import errno
 
 from gunicorn.errors import AppImportError
 from gunicorn.six import text_type
@@ -152,6 +153,14 @@ def set_owner_process(uid, gid):
         # groups like on osx or fedora
         gid = abs(gid) & 0x7FFFFFFF
         os.setgid(gid)
+
+        # Also drop supplemental groups
+        try:
+            os.setgroups([])
+        except OSError as e:
+            if e.errno != errno.EPERM:
+                raise
+
     if uid:
         os.setuid(uid)
 
